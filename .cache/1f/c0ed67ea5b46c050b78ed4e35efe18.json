{"id":"DQX5","dependencies":[{"name":"D:\\Projects\\ol\\package.json","includedInParent":true,"mtime":1586548571472},{"name":"D:\\Projects\\ol\\node_modules\\ol\\package.json","includedInParent":true,"mtime":1586157047249},{"name":"../util.js","loc":{"line":17,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\util.js"},{"name":"../Collection.js","loc":{"line":18,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\Collection.js"},{"name":"../CollectionEventType.js","loc":{"line":19,"column":32},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\CollectionEventType.js"},{"name":"../Feature.js","loc":{"line":20,"column":20},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\Feature.js"},{"name":"../MapBrowserEventType.js","loc":{"line":21,"column":32},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\MapBrowserEventType.js"},{"name":"../array.js","loc":{"line":22,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\array.js"},{"name":"../coordinate.js","loc":{"line":23,"column":165},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\coordinate.js"},{"name":"../events/Event.js","loc":{"line":24,"column":18},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\events\\Event.js"},{"name":"../events/EventType.js","loc":{"line":25,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\events\\EventType.js"},{"name":"../events/condition.js","loc":{"line":26,"column":63},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\events\\condition.js"},{"name":"../extent.js","loc":{"line":27,"column":101},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\extent.js"},{"name":"../geom/GeometryType.js","loc":{"line":28,"column":25},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\geom\\GeometryType.js"},{"name":"../geom/Point.js","loc":{"line":29,"column":18},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\geom\\Point.js"},{"name":"../geom/Polygon.js","loc":{"line":30,"column":27},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\geom\\Polygon.js"},{"name":"./Pointer.js","loc":{"line":31,"column":31},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Pointer.js"},{"name":"../layer/Vector.js","loc":{"line":32,"column":24},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\layer\\Vector.js"},{"name":"../source/Vector.js","loc":{"line":33,"column":25},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\Vector.js"},{"name":"../source/VectorEventType.js","loc":{"line":34,"column":28},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\VectorEventType.js"},{"name":"../structs/RBush.js","loc":{"line":35,"column":18},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\structs\\RBush.js"},{"name":"../style/Style.js","loc":{"line":36,"column":35},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\style\\Style.js"},{"name":"../proj.js","loc":{"line":37,"column":102},"parent":"D:\\Projects\\ol\\node_modules\\ol\\interaction\\Modify.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\proj.js"}],"generated":{"js":"var $DQX5$exports={};$parcel$require(\"DQX5\",\"../util.js\"),$parcel$require(\"DQX5\",\"../Collection.js\"),$parcel$require(\"DQX5\",\"../CollectionEventType.js\"),$parcel$require(\"DQX5\",\"../Feature.js\"),$parcel$require(\"DQX5\",\"../MapBrowserEventType.js\"),$parcel$require(\"DQX5\",\"../array.js\"),$parcel$require(\"DQX5\",\"../coordinate.js\"),$parcel$require(\"DQX5\",\"../events/Event.js\"),$parcel$require(\"DQX5\",\"../events/EventType.js\"),$parcel$require(\"DQX5\",\"../events/condition.js\"),$parcel$require(\"DQX5\",\"../extent.js\"),$parcel$require(\"DQX5\",\"../geom/GeometryType.js\"),$parcel$require(\"DQX5\",\"../geom/Point.js\"),$parcel$require(\"DQX5\",\"../geom/Polygon.js\"),$parcel$require(\"DQX5\",\"./Pointer.js\"),$parcel$require(\"DQX5\",\"../layer/Vector.js\"),$parcel$require(\"DQX5\",\"../source/Vector.js\"),$parcel$require(\"DQX5\",\"../source/VectorEventType.js\"),$parcel$require(\"DQX5\",\"../structs/RBush.js\"),$parcel$require(\"DQX5\",\"../style/Style.js\"),$parcel$require(\"DQX5\",\"../proj.js\");var $DQX5$var$__extends=$DQX5$exports&&$DQX5$exports.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$DQX5$var$CIRCLE_CENTER_INDEX=0,$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX=1,$DQX5$var$tempExtent=[0,0,0,0],$DQX5$var$tempSegment=[],$DQX5$var$ModifyEventType={MODIFYSTART:\"modifystart\",MODIFYEND:\"modifyend\"},$DQX5$export$ModifyEvent=function(e){function t(t,r,i){var o=e.call(this,t)||this;return o.features=r,o.mapBrowserEvent=i,o}return $DQX5$var$__extends(t,e),t}($DQX5$import$Event);$DQX5$exports.ModifyEvent=$DQX5$export$ModifyEvent;var $DQX5$export$default=function(e){function t(t){var r,i=e.call(this,t)||this;if(i.boundHandleFeatureChange_=i.handleFeatureChange_.bind(i),i.condition_=t.condition?t.condition:$DQX5$import$primaryAction,i.defaultDeleteCondition_=function(e){return $DQX5$import$altKeyOnly(e)&&$DQX5$import$singleClick(e)},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:$DQX5$import$always,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.modified_=!1,i.rBush_=new $DQX5$import$RBush,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new $DQX5$import$VectorLayer({source:new $DQX5$import$VectorSource({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:$DQX5$var$getDefaultStyleFunction(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(i),LineString:i.writeLineStringGeometry_.bind(i),LinearRing:i.writeLineStringGeometry_.bind(i),Polygon:i.writePolygonGeometry_.bind(i),MultiPoint:i.writeMultiPointGeometry_.bind(i),MultiLineString:i.writeMultiLineStringGeometry_.bind(i),MultiPolygon:i.writeMultiPolygonGeometry_.bind(i),Circle:i.writeCircleGeometry_.bind(i),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(i)},i.source_=null,t.source?(i.source_=t.source,r=new $DQX5$import$Collection(i.source_.getFeatures()),i.source_.addEventListener($DQX5$import$VectorEventType.ADDFEATURE,i.handleSourceAdd_.bind(i)),i.source_.addEventListener($DQX5$import$VectorEventType.REMOVEFEATURE,i.handleSourceRemove_.bind(i))):r=t.features,!r)throw new Error(\"The modify interaction requires features or a source\");return i.features_=r,i.features_.forEach(i.addFeature_.bind(i)),i.features_.addEventListener($DQX5$import$CollectionEventType.ADD,i.handleFeatureAdd_.bind(i)),i.features_.addEventListener($DQX5$import$CollectionEventType.REMOVE,i.handleFeatureRemove_.bind(i)),i.lastPointerEvent_=null,i}return $DQX5$var$__extends(t,e),t.prototype.addFeature_=function(e){var t=e.getGeometry();if(t){var r=this.SEGMENT_WRITERS_[t.getType()];r&&r(e,t)}var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),e.addEventListener($DQX5$import$EventType.CHANGE,this.boundHandleFeatureChange_)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new $DQX5$export$ModifyEvent($DQX5$var$ModifyEventType.MODIFYSTART,this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener($DQX5$import$EventType.CHANGE,this.boundHandleFeatureChange_)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,r=[];t.forEach(function(t){e===t.feature&&r.push(t)});for(var i=r.length-1;i>=0;--i){for(var o=r[i],n=this.dragSegments_.length-1;n>=0;--n)this.dragSegments_[n][0]===o&&this.dragSegments_.splice(n,1);t.remove(o)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i){var n=r[i],a={feature:e,geometry:t,depth:[i],index:i,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length-1;i<o;++i){var n=r.slice(i,i+2),a={feature:e,geometry:t,index:i,segment:n};this.rBush_.insert($DQX5$import$boundingExtent(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert($DQX5$import$boundingExtent($),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert($DQX5$import$boundingExtent($),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length;a<s;++a)for(var $=n[a],p=0,m=$.length-1;p<m;++p){var u=$.slice(p,p+2),d={feature:e,geometry:t,depth:[a,i],index:p,segment:u};this.rBush_.insert($DQX5$import$boundingExtent(u),d)}},t.prototype.writeCircleGeometry_=function(e,t){var r=t.getCenter(),i={feature:e,geometry:t,index:$DQX5$var$CIRCLE_CENTER_INDEX,segment:[r,r]},o={feature:e,geometry:t,index:$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX,segment:[r,r]},n=[i,o];i.featureSegments=n,o.featureSegments=n,this.rBush_.insert($DQX5$import$createExtent(r),i);var a=t,s=$DQX5$import$getUserProjection();if(s&&this.getMap()){var $=this.getMap().getView().getProjection();a=a.clone().transform(s,$),a=$DQX5$import$fromCircle(a).transform($,s)}this.rBush_.insert(a.getExtent(),o)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i){var o=r[i];(0,this.SEGMENT_WRITERS_[o.getType()])(e,o)}},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new $DQX5$import$Feature(new $DQX5$import$Point(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=$DQX5$import$MapBrowserEventType.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(r=!(t.type!=$DQX5$import$MapBrowserEventType.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==$DQX5$import$MapBrowserEventType.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!r);var r},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,r=0,i=this.dragSegments_.length;r<i;++r){for(var o=this.dragSegments_[r],n=o[0],a=n.depth,s=n.geometry,$=void 0,p=n.segment,m=o[1];t.length<s.getStride();)t.push(p[m][t.length]);switch(s.getType()){case $DQX5$import$GeometryType.POINT:$=t,p[0]=t,p[1]=t;break;case $DQX5$import$GeometryType.MULTI_POINT:($=s.getCoordinates())[n.index]=t,p[0]=t,p[1]=t;break;case $DQX5$import$GeometryType.LINE_STRING:($=s.getCoordinates())[n.index+m]=t,p[m]=t;break;case $DQX5$import$GeometryType.MULTI_LINE_STRING:case $DQX5$import$GeometryType.POLYGON:($=s.getCoordinates())[a[0]][n.index+m]=t,p[m]=t;break;case $DQX5$import$GeometryType.MULTI_POLYGON:($=s.getCoordinates())[a[1]][a[0]][n.index+m]=t,p[m]=t;break;case $DQX5$import$GeometryType.CIRCLE:if(p[0]=t,p[1]=t,n.index===$DQX5$var$CIRCLE_CENTER_INDEX)this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var u=e.map.getView().getProjection(),d=$DQX5$import$coordinateDistance($DQX5$import$fromUserCoordinate(s.getCenter(),u),$DQX5$import$fromUserCoordinate(t,u)),g=$DQX5$import$getUserProjection();if(g){var h=s.clone().transform(g,u);h.setRadius(d),d=h.transform(u,g).getRadius()}s.setRadius(d),this.changingFeature_=!1}}$&&this.setGeometryCoordinates_(s,$)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.modified_=!1;var r=this.vertexFeature_;if(r){var i=e.map.getView().getProjection(),o=[],n=r.getGeometry().getCoordinates(),a=$DQX5$import$boundingExtent([n]),s=this.rBush_.getInExtent(a),$={};s.sort($DQX5$var$compareIndexes);for(var p=0,m=s.length;p<m;++p){var u=s[p],d=u.segment,g=$DQX5$import$getUid(u.feature),h=u.depth;if(h&&(g+=\"-\"+h.join(\"-\")),$[g]||($[g]=new Array(2)),u.geometry.getType()!==$DQX5$import$GeometryType.CIRCLE||u.index!==$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX)if(!$DQX5$import$coordinatesEqual(d[0],n)||$[g][0])if(!$DQX5$import$coordinatesEqual(d[1],n)||$[g][1])$DQX5$import$getUid(d)in this.vertexSegments_&&!$[g][0]&&!$[g][1]&&this.insertVertexCondition_(e)&&o.push([u,n]);else{if((u.geometry.getType()===$DQX5$import$GeometryType.LINE_STRING||u.geometry.getType()===$DQX5$import$GeometryType.MULTI_LINE_STRING)&&$[g][0]&&0===$[g][0].index)continue;this.dragSegments_.push([u,1]),$[g][1]=u}else this.dragSegments_.push([u,0]),$[g][0]=u;else{var l=$DQX5$var$closestOnSegmentData(t,u,i);$DQX5$import$coordinatesEqual(l,n)&&!$[g][0]&&(this.dragSegments_.push([u,0]),$[g][0]=u)}}o.length&&this.willModifyFeatures_(e);for(var c=o.length-1;c>=0;--c)this.insertVertex_.apply(this,o[c])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],i=r.geometry;if(i.getType()===$DQX5$import$GeometryType.CIRCLE){var o=i.getCenter(),n=r.featureSegments[0],a=r.featureSegments[1];n.segment[0]=o,n.segment[1]=o,a.segment[0]=o,a.segment[1]=o,this.rBush_.update($DQX5$import$createExtent(o),n);var s=i,$=$DQX5$import$getUserProjection();if($){var p=e.map.getView().getProjection();s=s.clone().transform($,p),s=$DQX5$import$fromCircle(s).transform(p,$)}this.rBush_.update(s.getExtent(),a)}else this.rBush_.update($DQX5$import$boundingExtent(r.segment),r)}return this.modified_&&(this.dispatchEvent(new $DQX5$export$ModifyEvent($DQX5$var$ModifyEventType.MODIFYEND,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},t.prototype.handlePointerAtPixel_=function(e,t,r){var i=r||t.getCoordinateFromPixel(e),o=t.getView().getProjection(),n=$DQX5$import$fromUserExtent($DQX5$import$createExtent(i,$DQX5$var$tempExtent),o),a=t.getView().getResolution()*this.pixelTolerance_,s=$DQX5$import$toUserExtent($DQX5$import$bufferExtent(n,a,$DQX5$var$tempExtent),o),$=this.rBush_.getInExtent(s);if($.length>0){$.sort(function(e,t){return $DQX5$var$projectedDistanceToSegmentDataSquared(i,e,o)-$DQX5$var$projectedDistanceToSegmentDataSquared(i,t,o)});var p=$[0],m=p.segment,u=$DQX5$var$closestOnSegmentData(i,p,o),d=t.getPixelFromCoordinate(u),g=$DQX5$import$coordinateDistance(e,d);if(g<=this.pixelTolerance_){var h={};if(p.geometry.getType()===$DQX5$import$GeometryType.CIRCLE&&p.index===$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{var l=t.getPixelFromCoordinate(m[0]),c=t.getPixelFromCoordinate(m[1]),_=$DQX5$import$squaredCoordinateDistance(d,l),v=$DQX5$import$squaredCoordinateDistance(d,c);g=Math.sqrt(Math.min(_,v)),this.snappedToVertex_=g<=this.pixelTolerance_,this.snappedToVertex_&&(u=_>v?m[1]:m[0]),this.createOrUpdateVertexFeature_(u);for(var y=1,D=$.length;y<D;++y){var f=$[y].segment;if(!($DQX5$import$coordinatesEqual(m[0],f[0])&&$DQX5$import$coordinatesEqual(m[1],f[1])||$DQX5$import$coordinatesEqual(m[0],f[1])&&$DQX5$import$coordinatesEqual(m[1],f[0])))break;h[$DQX5$import$getUid(f)]=!0}}return h[$DQX5$import$getUid(m)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var r,i=e.segment,o=e.feature,n=e.geometry,a=e.depth,s=e.index;t.length<n.getStride();)t.push(0);switch(n.getType()){case $DQX5$import$GeometryType.MULTI_LINE_STRING:case $DQX5$import$GeometryType.POLYGON:(r=n.getCoordinates())[a[0]].splice(s+1,0,t);break;case $DQX5$import$GeometryType.MULTI_POLYGON:(r=n.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case $DQX5$import$GeometryType.LINE_STRING:(r=n.getCoordinates()).splice(s+1,0,t);break;default:return}this.setGeometryCoordinates_(n,r);var $=this.rBush_;$.remove(e),this.updateSegmentIndices_(n,s,a,1);var p={segment:[i[0],t],feature:o,geometry:n,depth:a,index:s};$.insert($DQX5$import$boundingExtent(p.segment),p),this.dragSegments_.push([p,1]);var m={segment:[t,i[1]],feature:o,geometry:n,depth:a,index:s+1};$.insert($DQX5$import$boundingExtent(m.segment),m),this.dragSegments_.push([m,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=$DQX5$import$MapBrowserEventType.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e);var t=this.removeVertex_();return this.dispatchEvent(new $DQX5$export$ModifyEvent($DQX5$var$ModifyEventType.MODIFYEND,this.features_,e)),this.modified_=!1,t}return!1},t.prototype.removeVertex_=function(){var e,t,r,i,o,n,a,s,$,p,m,u=this.dragSegments_,d={},g=!1;for(o=u.length-1;o>=0;--o)p=(r=u[o])[0],m=$DQX5$import$getUid(p.feature),p.depth&&(m+=\"-\"+p.depth.join(\"-\")),m in d||(d[m]={}),0===r[1]?(d[m].right=p,d[m].index=p.index):1==r[1]&&(d[m].left=p,d[m].index=p.index+1);for(m in d){switch($=d[m].right,a=d[m].left,(s=(n=d[m].index)-1)<0&&(s=0),e=t=(i=(p=void 0!==a?a:$).geometry).getCoordinates(),g=!1,i.getType()){case $DQX5$import$GeometryType.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(n,1),g=!0);break;case $DQX5$import$GeometryType.LINE_STRING:t.length>2&&(t.splice(n,1),g=!0);break;case $DQX5$import$GeometryType.MULTI_POLYGON:e=e[p.depth[1]];case $DQX5$import$GeometryType.POLYGON:(e=e[p.depth[0]]).length>4&&(n==e.length-1&&(n=0),e.splice(n,1),g=!0,0===n&&(e.pop(),e.push(e[0]),s=e.length-1))}if(g){this.setGeometryCoordinates_(i,t);var h=[];if(void 0!==a&&(this.rBush_.remove(a),h.push(a.segment[0])),void 0!==$&&(this.rBush_.remove($),h.push($.segment[1])),void 0!==a&&void 0!==$){var l={depth:p.depth,feature:p.feature,geometry:p.geometry,index:s,segment:h};this.rBush_.insert($DQX5$import$boundingExtent(l.segment),l)}this.updateSegmentIndices_(i,n,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),u.length=0}}return g},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(o){o.geometry===e&&(void 0===r||void 0===o.depth||$DQX5$import$equals(o.depth,r))&&o.index>t&&(o.index+=i)})},t}($DQX5$import$PointerInteraction);function $DQX5$var$compareIndexes(e,t){return e.index-t.index}function $DQX5$var$projectedDistanceToSegmentDataSquared(e,t,r){var i=t.geometry;if(i.getType()===$DQX5$import$GeometryType.CIRCLE){var o=i;if(t.index===$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX){var n=$DQX5$import$getUserProjection();n&&(o=o.clone().transform(n,r));var a=$DQX5$import$squaredCoordinateDistance(o.getCenter(),$DQX5$import$fromUserCoordinate(e,r)),s=Math.sqrt(a)-o.getRadius();return s*s}}var $=$DQX5$import$fromUserCoordinate(e,r);return $DQX5$var$tempSegment[0]=$DQX5$import$fromUserCoordinate(t.segment[0],r),$DQX5$var$tempSegment[1]=$DQX5$import$fromUserCoordinate(t.segment[1],r),$DQX5$import$squaredDistanceToSegment($,$DQX5$var$tempSegment)}function $DQX5$var$closestOnSegmentData(e,t,r){var i=t.geometry;if(i.getType()===$DQX5$import$GeometryType.CIRCLE&&t.index===$DQX5$var$CIRCLE_CIRCUMFERENCE_INDEX){var o=i,n=$DQX5$import$getUserProjection();return n&&(o=o.clone().transform(n,r)),$DQX5$import$toUserCoordinate(o.getClosestPoint($DQX5$import$fromUserCoordinate(e,r)),r)}var a=$DQX5$import$fromUserCoordinate(e,r);return $DQX5$var$tempSegment[0]=$DQX5$import$fromUserCoordinate(t.segment[0],r),$DQX5$var$tempSegment[1]=$DQX5$import$fromUserCoordinate(t.segment[1],r),$DQX5$import$toUserCoordinate($DQX5$import$closestOnSegment(a,$DQX5$var$tempSegment),r)}function $DQX5$var$getDefaultStyleFunction(){var e=$DQX5$import$createEditingStyle();return function(t,r){return e[$DQX5$import$GeometryType.POINT]}}$DQX5$exports.default=$DQX5$export$default;"},"sourceMaps":null,"error":null,"hash":"6c6e9e1bfc0527bf66ddaefbae48e95c","cacheData":{"env":{},"imports":{"$DQX5$import$getUid":["../util.js","getUid"],"$DQX5$import$Collection":["../Collection.js","default"],"$DQX5$import$CollectionEventType":["../CollectionEventType.js","default"],"$DQX5$import$Feature":["../Feature.js","default"],"$DQX5$import$MapBrowserEventType":["../MapBrowserEventType.js","default"],"$DQX5$import$equals":["../array.js","equals"],"$DQX5$import$coordinatesEqual":["../coordinate.js","equals"],"$DQX5$import$coordinateDistance":["../coordinate.js","distance"],"$DQX5$import$squaredCoordinateDistance":["../coordinate.js","squaredDistance"],"$DQX5$import$squaredDistanceToSegment":["../coordinate.js","squaredDistanceToSegment"],"$DQX5$import$closestOnSegment":["../coordinate.js","closestOnSegment"],"$DQX5$import$Event":["../events/Event.js","default"],"$DQX5$import$EventType":["../events/EventType.js","default"],"$DQX5$import$always":["../events/condition.js","always"],"$DQX5$import$primaryAction":["../events/condition.js","primaryAction"],"$DQX5$import$altKeyOnly":["../events/condition.js","altKeyOnly"],"$DQX5$import$singleClick":["../events/condition.js","singleClick"],"$DQX5$import$boundingExtent":["../extent.js","boundingExtent"],"$DQX5$import$bufferExtent":["../extent.js","buffer"],"$DQX5$import$createExtent":["../extent.js","createOrUpdateFromCoordinate"],"$DQX5$import$GeometryType":["../geom/GeometryType.js","default"],"$DQX5$import$Point":["../geom/Point.js","default"],"$DQX5$import$fromCircle":["../geom/Polygon.js","fromCircle"],"$DQX5$import$PointerInteraction":["./Pointer.js","default"],"$DQX5$import$VectorLayer":["../layer/Vector.js","default"],"$DQX5$import$VectorSource":["../source/Vector.js","default"],"$DQX5$import$VectorEventType":["../source/VectorEventType.js","default"],"$DQX5$import$RBush":["../structs/RBush.js","default"],"$DQX5$import$createEditingStyle":["../style/Style.js","createEditingStyle"],"$DQX5$import$getUserProjection":["../proj.js","getUserProjection"],"$DQX5$import$fromUserExtent":["../proj.js","fromUserExtent"],"$DQX5$import$toUserExtent":["../proj.js","toUserExtent"],"$DQX5$import$fromUserCoordinate":["../proj.js","fromUserCoordinate"],"$DQX5$import$toUserCoordinate":["../proj.js","toUserCoordinate"]},"exports":{"ModifyEvent":"$DQX5$export$ModifyEvent","default":"$DQX5$export$default"},"wildcards":[],"sideEffects":false,"isCommonJS":true,"isES6Module":true}}