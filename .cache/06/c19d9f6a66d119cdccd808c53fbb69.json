{"id":"ISPk","dependencies":[{"name":"D:\\Projects\\ol\\package.json","includedInParent":true,"mtime":1586548571472},{"name":"D:\\Projects\\ol\\node_modules\\ol\\package.json","includedInParent":true,"mtime":1586157047249},{"name":"../../util.js","loc":{"line":17,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\util.js"},{"name":"../../proj.js","loc":{"line":18,"column":31},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\proj.js"},{"name":"../../TileRange.js","loc":{"line":19,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\TileRange.js"},{"name":"../../TileState.js","loc":{"line":20,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\TileState.js"},{"name":"../../extent.js","loc":{"line":21,"column":65},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\extent.js"},{"name":"./Layer.js","loc":{"line":22,"column":32},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\Layer.js"},{"name":"../../transform.js","loc":{"line":23,"column":82},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\transform.js"},{"name":"../../array.js","loc":{"line":24,"column":42},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\array.js"},{"name":"../../render/canvas.js","loc":{"line":25,"column":38},"parent":"D:\\Projects\\ol\\node_modules\\ol\\renderer\\canvas\\TileLayer.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\render\\canvas.js"}],"generated":{"js":"var $ISPk$exports={};$parcel$require(\"ISPk\",\"../../util.js\"),$parcel$require(\"ISPk\",\"../../proj.js\"),$parcel$require(\"ISPk\",\"../../TileRange.js\"),$parcel$require(\"ISPk\",\"../../TileState.js\"),$parcel$require(\"ISPk\",\"../../extent.js\"),$parcel$require(\"ISPk\",\"./Layer.js\"),$parcel$require(\"ISPk\",\"../../transform.js\"),$parcel$require(\"ISPk\",\"../../array.js\"),$parcel$require(\"ISPk\",\"../../render/canvas.js\");var $ISPk$var$__extends=$ISPk$exports&&$ISPk$exports.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$ISPk$export$default=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=$ISPk$import$createEmpty(),r.tmpTileRange_=new $ISPk$import$TileRange(0,0,0,0),r}return $ISPk$var$__extends(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==$ISPk$import$TileState.LOADED||r==$ISPk$import$TileState.EMPTY||r==$ISPk$import$TileState.ERROR&&!i},t.prototype.getTile=function(e,t,r,i){var o=i.pixelRatio,n=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(e,t,r,o,n);return s.getState()==$ISPk$import$TileState.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState($ISPk$import$TileState.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},t.prototype.loadedTileCallback=function(t,r,i){return!!this.isDrawableTile(i)&&e.prototype.loadedTileCallback.call(this,t,r,i)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,n=i.resolution,a=i.center,s=i.rotation,l=e.pixelRatio,p=this.getLayer(),$=p.getSource(),d=$.getRevision(),h=$.getTileGridForProjection(o),u=h.getZForResolution(n,$.zDirection),c=h.getResolution(u),m=e.extent,g=r.extent&&$ISPk$import$fromUserExtent(r.extent,o);g&&(m=$ISPk$import$getIntersection(m,$ISPk$import$fromUserExtent(r.extent,o)));var T=$.getTilePixelRatio(l),S=Math.round(e.size[0]*T),f=Math.round(e.size[1]*T);if(s){var P=Math.round(Math.sqrt(S*S+f*f));S=P,f=P}var I=c*S/2/T,v=c*f/2/T,x=[a[0]-I,a[1]-v,a[0]+I,a[1]+v],k=h.getTileRangeForExtentAndZ(m,u),y={};y[u]={};var R=this.createLoadedTileFinder($,o,y),_=this.tmpExtent,w=this.tmpTileRange_;this.newTiles_=!1;for(var E=k.minX;E<=k.maxX;++E)for(var C=k.minY;C<=k.maxY;++C){var j=this.getTile(u,E,C,e);if(this.isDrawableTile(j)){var b=$ISPk$import$getUid(this);if(j.getState()==$ISPk$import$TileState.LOADED){y[u][j.tileCoord.toString()]=j;var O=j.inTransition(b);this.newTiles_||!O&&-1!==this.renderedTiles.indexOf(j)||(this.newTiles_=!0)}if(1===j.getAlpha(b,e.time))continue}var q=h.getTileCoordChildTileRange(j.tileCoord,w,_),A=!1;q&&(A=R(u+1,q)),A||h.forEachTileCoordParentTileRange(j.tileCoord,R,w,_)}var L=c/n;$ISPk$import$composeTransform(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/T,1/T,s,-S/2,-f/2);var U=$ISPk$import$createTransformString(this.pixelTransform);this.useContainer(t,U,r.opacity);var D=this.context,F=D.canvas;$ISPk$import$makeInverse(this.inversePixelTransform,this.pixelTransform),$ISPk$import$composeTransform(this.tempTransform_,S/2,f/2,L,L,0,-S/2,-f/2),F.width!=S||F.height!=f?(F.width=S,F.height=f):this.containerReused||D.clearRect(0,0,S,f),g&&this.clipUnrotated(D,e,g),this.preRender(D,e),this.renderedTiles.length=0;var M,z,Y,Z=Object.keys(y).map(Number);Z.sort($ISPk$import$numberSafeCompareFunction),1!==r.opacity||this.containerReused&&!$.getOpaque(e.viewState.projection)?(M=[],z=[]):Z=Z.reverse();for(var K=Z.length-1;K>=0;--K){var X=Z[K],G=$.getTilePixelSize(X,l,o),Q=h.getResolution(X)/c,N=G[0]*Q*L,B=G[1]*Q*L,H=h.getTileCoordForCoordAndZ($ISPk$import$getTopLeft(x),X),J=h.getTileCoordExtent(H),V=$ISPk$import$applyTransform(this.tempTransform_,[T*(J[0]-x[0])/c,T*(x[3]-J[3])/c]),W=T*$.getGutterForProjection(o),ee=y[X];for(var te in ee){var re=(j=ee[te]).tileCoord,ie=V[0]-(H[1]-re[1])*N,oe=Math.round(ie+N),ne=V[1]-(H[2]-re[2])*B,ae=Math.round(ne+B),se=oe-(E=Math.round(ie)),le=ae-(C=Math.round(ne)),pe=u===X;if(!(O=pe&&1!==j.getAlpha($ISPk$import$getUid(this),e.time)))if(M){D.save(),Y=[E,C,E+se,C,E+se,C+le,E,C+le];for(var $e=0,de=M.length;$e<de;++$e)if(u!==X&&X<z[$e]){var he=M[$e];D.beginPath(),D.moveTo(Y[0],Y[1]),D.lineTo(Y[2],Y[3]),D.lineTo(Y[4],Y[5]),D.lineTo(Y[6],Y[7]),D.moveTo(he[6],he[7]),D.lineTo(he[4],he[5]),D.lineTo(he[2],he[3]),D.lineTo(he[0],he[1]),D.clip()}M.push(Y),z.push(X)}else D.clearRect(E,C,se,le);this.drawTileImage(j,e,E,C,se,le,W,pe,r.opacity),M&&!O&&D.restore(),this.renderedTiles.push(j),this.updateUsedTiles(e.usedTiles,$,j)}}return this.renderedRevision=d,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!$ISPk$import$equals(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=l,this.renderedProjection=o,this.manageTilePyramid(e,$,h,l,o,m,u,p.getPreload()),this.scheduleExpireCache(e,$),this.postRender(D,e),r.extent&&D.restore(),U!==F.style.transform&&(F.style.transform=U),this.container},t.prototype.drawTileImage=function(e,t,r,i,o,n,a,s,l){var p=this.getTileImage(e);if(p){var $=$ISPk$import$getUid(this),d=s?e.getAlpha($,t.time):1,h=l*d,u=h!==this.context.globalAlpha;u&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(p,a,a,p.width-2*a,p.height-2*a,r,i,o,n),u&&this.context.restore(),1!==d?t.animate=!0:s&&e.endTransition($)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=$ISPk$import$getUid(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var i=$ISPk$import$getUid(t);i in e||(e[i]={}),e[i][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,i,o,n,a,s,l){var p=$ISPk$import$getUid(t);p in e.wantedTiles||(e.wantedTiles[p]={});var $,d,h,u,c,m,g=e.wantedTiles[p],T=e.tileQueue;for(m=r.getMinZoom();m<=a;++m)for(d=r.getTileRangeForExtentAndZ(n,m,d),h=r.getResolution(m),u=d.minX;u<=d.maxX;++u)for(c=d.minY;c<=d.maxY;++c)a-m<=s?(($=t.getTile(m,u,c,i,o)).getState()==$ISPk$import$TileState.IDLE&&(g[$.getKey()]=!0,T.isKeyQueued($.getKey())||T.enqueue([$,p,r.getTileCoordCenter($.tileCoord),h])),void 0!==l&&l($)):t.useTile(m,u,c,o)},t}($ISPk$import$CanvasLayerRenderer);$ISPk$export$default.prototype.getLayer,$ISPk$exports.default=$ISPk$export$default;"},"sourceMaps":null,"error":null,"hash":"4fef931f44bf24903e26818c0ef26e0e","cacheData":{"env":{},"imports":{"$ISPk$import$getUid":["../../util.js","getUid"],"$ISPk$import$fromUserExtent":["../../proj.js","fromUserExtent"],"$ISPk$import$TileRange":["../../TileRange.js","default"],"$ISPk$import$TileState":["../../TileState.js","default"],"$ISPk$import$createEmpty":["../../extent.js","createEmpty"],"$ISPk$import$equals":["../../extent.js","equals"],"$ISPk$import$getIntersection":["../../extent.js","getIntersection"],"$ISPk$import$getTopLeft":["../../extent.js","getTopLeft"],"$ISPk$import$CanvasLayerRenderer":["./Layer.js","default"],"$ISPk$import$applyTransform":["../../transform.js","apply"],"$ISPk$import$composeTransform":["../../transform.js","compose"],"$ISPk$import$makeInverse":["../../transform.js","makeInverse"],"$ISPk$import$numberSafeCompareFunction":["../../array.js","numberSafeCompareFunction"],"$ISPk$import$createTransformString":["../../render/canvas.js","createTransformString"]},"exports":{"default":"$ISPk$export$default"},"wildcards":[],"sideEffects":false,"isCommonJS":true,"isES6Module":true}}