{"id":"xFSo","dependencies":[{"name":"D:\\Projects\\ol\\package.json","includedInParent":true,"mtime":1586548571472},{"name":"D:\\Projects\\ol\\node_modules\\ol\\package.json","includedInParent":true,"mtime":1586157047249},{"name":"../ImageCanvas.js","loc":{"line":17,"column":24},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\ImageCanvas.js"},{"name":"../TileQueue.js","loc":{"line":18,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\TileQueue.js"},{"name":"../dom.js","loc":{"line":19,"column":38},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\dom.js"},{"name":"../events/Event.js","loc":{"line":20,"column":18},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\events\\Event.js"},{"name":"../events/EventType.js","loc":{"line":21,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\events\\EventType.js"},{"name":"pixelworks/lib/index.js","loc":{"line":22,"column":26},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\pixelworks\\lib\\index.js"},{"name":"../extent.js","loc":{"line":23,"column":55},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\extent.js"},{"name":"../layer/Image.js","loc":{"line":24,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\layer\\Image.js"},{"name":"../layer/Tile.js","loc":{"line":25,"column":22},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\layer\\Tile.js"},{"name":"../obj.js","loc":{"line":26,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\obj.js"},{"name":"../transform.js","loc":{"line":27,"column":42},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\transform.js"},{"name":"./Image.js","loc":{"line":28,"column":24},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\Image.js"},{"name":"./Tile.js","loc":{"line":29,"column":23},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\Tile.js"},{"name":"./State.js","loc":{"line":30,"column":24},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\State.js"},{"name":"./Source.js","loc":{"line":31,"column":19},"parent":"D:\\Projects\\ol\\node_modules\\ol\\source\\Raster.js","resolved":"D:\\Projects\\ol\\node_modules\\ol\\source\\Source.js"}],"generated":{"js":"var $xFSo$exports={};$parcel$require(\"xFSo\",\"../ImageCanvas.js\"),$parcel$require(\"xFSo\",\"../TileQueue.js\"),$parcel$require(\"xFSo\",\"../dom.js\"),$parcel$require(\"xFSo\",\"../events/Event.js\"),$parcel$require(\"xFSo\",\"../events/EventType.js\"),$parcel$require(\"xFSo\",\"pixelworks/lib/index.js\"),$parcel$require(\"xFSo\",\"../extent.js\"),$parcel$require(\"xFSo\",\"../layer/Image.js\"),$parcel$require(\"xFSo\",\"../layer/Tile.js\"),$parcel$require(\"xFSo\",\"../obj.js\"),$parcel$require(\"xFSo\",\"../transform.js\"),$parcel$require(\"xFSo\",\"./Image.js\"),$parcel$require(\"xFSo\",\"./Tile.js\"),$parcel$require(\"xFSo\",\"./State.js\"),$parcel$require(\"xFSo\",\"./Source.js\");var $xFSo$var$__extends=$xFSo$exports&&$xFSo$exports.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),$xFSo$var$RasterEventType={BEFOREOPERATIONS:\"beforeoperations\",AFTEROPERATIONS:\"afteroperations\"},$xFSo$var$RasterOperationType={PIXEL:\"pixel\",IMAGE:\"image\"},$xFSo$export$RasterSourceEvent=function(e){function t(t,r,o){var a=e.call(this,t)||this;return a.extent=r.extent,a.resolution=r.viewState.resolution/r.pixelRatio,a.data=o,a}return $xFSo$var$__extends(t,e),t}($xFSo$import$Event);$xFSo$exports.RasterSourceEvent=$xFSo$export$RasterSourceEvent;var $xFSo$export$default=function(e){function t(t){var r=e.call(this,{projection:null})||this;r.worker_=null,r.operationType_=void 0!==t.operationType?t.operationType:$xFSo$var$RasterOperationType.PIXEL,r.threads_=void 0!==t.threads?t.threads:1,r.layers_=$xFSo$var$createLayers(t.sources);for(var o=r.changed.bind(r),a=0,n=r.layers_.length;a<n;++a)r.layers_[a].addEventListener($xFSo$import$EventType.CHANGE,o);return r.tileQueue_=new $xFSo$import$TileQueue(function(){return 1},r.changed.bind(r)),r.requestedFrameState_,r.renderedImageCanvas_=null,r.renderedRevision_,r.frameState_={animate:!1,coordinateToPixelTransform:$xFSo$import$createTransform(),extent:null,index:0,layerIndex:0,layerStatesArray:$xFSo$var$getLayerStatesArray(r.layers_),pixelRatio:1,pixelToCoordinateTransform:$xFSo$import$createTransform(),postRenderFunctions:[],size:[0,0],tileQueue:r.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},r.setAttributions(function(e){for(var r=[],o=0,a=t.sources.length;o<a;++o){var n=t.sources[o],i=(n instanceof $xFSo$import$Source?n:n.getSource()).getAttributions();if(\"function\"==typeof i){var $=i(e);r.push.apply(r,$)}}return 0!==r.length?r:null}),void 0!==t.operation&&r.setOperation(t.operation,t.lib),r}return $xFSo$var$__extends(t,e),t.prototype.setOperation=function(e,t){this.worker_=new $xFSo$import$Processor({operation:e,imageOps:this.operationType_===$xFSo$var$RasterOperationType.IMAGE,queue:1,lib:t,threads:this.threads_}),this.changed()},t.prototype.updateFrameState_=function(e,t,r){var o=$xFSo$import$assign({},this.frameState_);o.viewState=$xFSo$import$assign({},o.viewState);var a=$xFSo$import$getCenter(e);o.extent=e.slice(),o.size[0]=Math.round($xFSo$import$getWidth(e)/t),o.size[1]=Math.round($xFSo$import$getHeight(e)/t),o.time=1/0;var n=o.viewState;return n.center=a,n.projection=r,n.resolution=t,o},t.prototype.allSourcesReady_=function(){for(var e=!0,t=0,r=this.layers_.length;t<r;++t)if(this.layers_[t].getSource().getState()!==$xFSo$import$SourceState.READY){e=!1;break}return e},t.prototype.getImage=function(e,t,r,o){if(!this.allSourcesReady_())return null;var a=this.updateFrameState_(e,t,o);if(this.requestedFrameState_=a,this.renderedImageCanvas_){var n=this.renderedImageCanvas_.getResolution(),i=this.renderedImageCanvas_.getExtent();t===n&&$xFSo$import$equals(e,i)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),a.tileQueue.loadMoreTiles(16,16),a.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},t.prototype.processSources_=function(){for(var e=this.requestedFrameState_,t=this.layers_.length,r=new Array(t),o=0;o<t;++o){e.layerIndex=o;var a=$xFSo$var$getImageData(this.layers_[o],e);if(!a)return;r[o]=a}var n={};this.dispatchEvent(new $xFSo$export$RasterSourceEvent($xFSo$var$RasterEventType.BEFOREOPERATIONS,e,n)),this.worker_.process(r,n,this.onWorkerComplete_.bind(this,e))},t.prototype.onWorkerComplete_=function(e,t,r,o){if(!t&&r){var a=e.extent,n=e.viewState.resolution;if(n===this.requestedFrameState_.viewState.resolution&&$xFSo$import$equals(a,this.requestedFrameState_.extent)){var i;if(this.renderedImageCanvas_)i=this.renderedImageCanvas_.getImage().getContext(\"2d\");else{var $=Math.round($xFSo$import$getWidth(a)/n),s=Math.round($xFSo$import$getHeight(a)/n);i=$xFSo$import$createCanvasContext2D($,s),this.renderedImageCanvas_=new $xFSo$import$ImageCanvas(a,n,1,i.canvas)}i.putImageData(r,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new $xFSo$export$RasterSourceEvent($xFSo$var$RasterEventType.AFTEROPERATIONS,e,o))}}},t.prototype.getImageInternal=function(){return null},t}($xFSo$import$ImageSource),$xFSo$var$sharedContext=null;function $xFSo$var$getImageData(e,t){var r=e.getRenderer();if(!r)throw new Error(\"Unsupported layer type: \"+e);if(!r.prepareFrame(t))return null;var o,a=t.size[0],n=t.size[1],i=r.renderFrame(t,null);if(i&&(o=i.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error(\"Unsupported rendered element: \"+o);if(o.width===a&&o.height===n)return o.getContext(\"2d\").getImageData(0,0,a,n);if($xFSo$var$sharedContext){var $=$xFSo$var$sharedContext.canvas;$.width!==a||$.height!==n?$xFSo$var$sharedContext=$xFSo$import$createCanvasContext2D(a,n):$xFSo$var$sharedContext.clearRect(0,0,a,n)}else $xFSo$var$sharedContext=$xFSo$import$createCanvasContext2D(a,n);return $xFSo$var$sharedContext.drawImage(o,0,0,a,n),$xFSo$var$sharedContext.getImageData(0,0,a,n)}function $xFSo$var$getLayerStatesArray(e){return e.map(function(e){return e.getLayerState()})}function $xFSo$var$createLayers(e){for(var t=e.length,r=new Array(t),o=0;o<t;++o)r[o]=$xFSo$var$createLayer(e[o]);return r}function $xFSo$var$createLayer(e){var t;return e instanceof $xFSo$import$Source?e instanceof $xFSo$import$TileSource?t=new $xFSo$import$TileLayer({source:e}):e instanceof $xFSo$import$ImageSource&&(t=new $xFSo$import$ImageLayer({source:e})):t=e,t}$xFSo$exports.default=$xFSo$export$default;"},"sourceMaps":null,"error":null,"hash":"bb313b27791864e94d83423f38988854","cacheData":{"env":{},"imports":{"$xFSo$import$ImageCanvas":["../ImageCanvas.js","default"],"$xFSo$import$TileQueue":["../TileQueue.js","default"],"$xFSo$import$createCanvasContext2D":["../dom.js","createCanvasContext2D"],"$xFSo$import$Event":["../events/Event.js","default"],"$xFSo$import$EventType":["../events/EventType.js","default"],"$xFSo$import$Processor":["pixelworks/lib/index.js","Processor"],"$xFSo$import$equals":["../extent.js","equals"],"$xFSo$import$getCenter":["../extent.js","getCenter"],"$xFSo$import$getHeight":["../extent.js","getHeight"],"$xFSo$import$getWidth":["../extent.js","getWidth"],"$xFSo$import$ImageLayer":["../layer/Image.js","default"],"$xFSo$import$TileLayer":["../layer/Tile.js","default"],"$xFSo$import$assign":["../obj.js","assign"],"$xFSo$import$createTransform":["../transform.js","create"],"$xFSo$import$ImageSource":["./Image.js","default"],"$xFSo$import$TileSource":["./Tile.js","default"],"$xFSo$import$SourceState":["./State.js","default"],"$xFSo$import$Source":["./Source.js","default"]},"exports":{"RasterSourceEvent":"$xFSo$export$RasterSourceEvent","default":"$xFSo$export$default"},"wildcards":[],"sideEffects":false,"isCommonJS":true,"isES6Module":true}}